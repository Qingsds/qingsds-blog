# 虚拟 DOM

> _**本事上是 JS 和 DOM之间的一个映射缓存 对真实 DOM 的描述,在形态上表现为 一个能描述 DOM 结构及其属性信息的 JS 对象**_

## 虚拟 DOM 的工作流程

### 挂载阶段

React 结合 JSX的描述,构建出虚拟 DOM 树,然后通过 ReactDOM.render 实现虚拟 DOM 到真实 DOM 的映射(触发渲染流水线)

### 更新阶段

页面的变化先会作用于虚拟 DOM,虚拟 DOM 将在 JS 层借助算法先对比出具体有哪些真实 DOM 需要被改变,然后再将这些改变作用于真实 DOM

## 为甚么需要虚拟 DOM

### 基于历史背景

1. 前端页面重展示阶段 --- js 只做辅助交互
2. jquery时代 --- dom 操作时代(手动吸尘器)
3. 模板引擎 --- 自动化渲染 更新的方式是先注销,整体重新渲染

- 模板引擎的处理流程 
  - 数据+模板 → 构建真实 DOM →挂载到界面
- **虚拟 DOM 处理流程**
  - **数据+"模板"(如JSX) → 虚拟 DOM →真实 DOM → 挂载到界面**
- **虚拟 DOM 作为缓存层实现了精准和差量的更新**

## React 选择虚拟 DOM 的原因

- 提供更爽更高效的研发模式(性能够用)
- 容易实现跨平台成本更低
- 避免人为操作DOM，降低代码风险

## 虚拟 DOM 的劣势

- 更大 JS 计算量(不可避免的递归,遍历等耗时操作)
- DOM 更新量不大时,性能可能不如其他方案
- 内存占用高
