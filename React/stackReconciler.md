
# React15中的"栈调和(Stack Reconciler)"的过程

## 调和和 Diff

- virtual DOM是一种编程概念,这种概念里,UI以一种"虚拟"的形式保存在内存中,并_通过 ReactDOM 等类库使之于"真实"DOM同步,这一过程叫做调和_**.(调和就是虚拟 DOM 映射到真实 DOM 的一个过程)**
- 调和过程并不能与 diff 划等号
  - 调和 → "使一致"的过程
  - diff → "找不同" 的过程

## Diff 算法

### 核心过程

> **_触发更新 → 生成补丁 → 应用补丁_**

### 优化方向

- 若两个组件属于同一类型,他们将拥有相同的 DOM 树结构
- 处于同一层级的子节点,可以通过设置 key做为唯一标识从而维持各个节点在不同渲染过程中的稳定性
- DOM 节点的跨层级操作并不多, 同层级操作是主流.

## Diff 算法优化策略 - 分治原则

### 树对比

> **_新旧虚拟 DOM 树只对同一层级的节点进行比较,如果发现节点不存在了,不会进行下一步比较,直接删除该节点及其子节点_**

### 组件对比

> **_如果组件是同一类型,进行树对比,如果不是 直接放入补丁_**

### 元素对比

> **_同层级中 通过 (tag) 或者节点(key)操作生成补丁,对比 key_**
